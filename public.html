<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book a Room - SmartBook</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); color: #1c1917; min-height: 100vh; padding: 0; }
        
        /* Header Section */
        .top-bar { background: white; border-bottom: 1px solid #e0e0e0; padding: 16px 32px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .top-bar-content { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 24px; font-weight: 700; color: #2563eb; display: flex; align-items: center; gap: 10px; }
        .logo-icon { width: 28px; height: 28px; background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); border-radius: 6px; }
        .back-link { color: #64748b; text-decoration: none; font-size: 14px; font-weight: 500; display: flex; align-items: center; gap: 6px; transition: color 0.3s; }
        .back-link:hover { color: #2563eb; }
        
        /* Main Container */
        .main-container { max-width: 1000px; margin: 0 auto; padding: 48px 32px; }
        
        /* Hero Section */
        .page-hero { text-align: center; margin-bottom: 48px; }
        .page-hero h1 { font-size: 42px; font-weight: 700; color: #1e293b; margin-bottom: 12px; background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .page-hero p { font-size: 18px; color: #64748b; }
        
        /* Progress Steps */
        .progress-steps { display: flex; justify-content: center; gap: 24px; margin-bottom: 48px; }
        .step { display: flex; align-items: center; gap: 12px; padding: 12px 24px; background: white; border-radius: 50px; border: 2px solid #e0e0e0; font-size: 14px; font-weight: 600; color: #94a3b8; }
        .step.active { border-color: #2563eb; color: #2563eb; box-shadow: 0 4px 12px rgba(37,99,235,0.15); }
        .step-number { width: 28px; height: 28px; background: #f1f5f9; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 13px; }
        .step.active .step-number { background: #2563eb; color: white; }
        
        /* Form Card */
        .form-wrapper { display: grid; grid-template-columns: 1fr 380px; gap: 32px; }
        .form-card { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 8px 32px rgba(0,0,0,0.08); border: 1px solid #e7e9ec; }
        .section-header { display: flex; align-items: center; gap: 12px; margin-bottom: 28px; }
        .section-icon { width: 40px; height: 40px; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center; }
        .section-icon svg { width: 20px; height: 20px; fill: #2563eb; }
        .section-header h2 { font-size: 22px; font-weight: 600; color: #1e293b; }
        
        .form-grid { display: grid; gap: 20px; }
        .form-group label { display: block; color: #475569; font-weight: 500; margin-bottom: 8px; font-size: 14px; }
        .required { color: #ef4444; }
        .input-wrapper { position: relative; }
        input, select, textarea { width: 100%; padding: 14px 16px; background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 10px; color: #1e293b; font-size: 15px; font-family: inherit; transition: all 0.3s; }
        input:focus, select:focus, textarea:focus { outline: none; background: white; border-color: #2563eb; box-shadow: 0 0 0 4px rgba(37,99,235,0.1); }
        select { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%2364748b' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 16px center; padding-right: 40px; }
        select option { background: white; color: #1e293b; }
        textarea { resize: vertical; min-height: 120px; }
        
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        .equipment-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px; }
        .equipment-item { position: relative; }
        .equipment-item input[type="checkbox"] { position: absolute; opacity: 0; }
        .equipment-label { display: flex; align-items: center; gap: 10px; padding: 14px; background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 10px; cursor: pointer; transition: all 0.3s; font-size: 14px; font-weight: 500; color: #475569; }
        .equipment-item input[type="checkbox"]:checked + .equipment-label { background: #eff6ff; border-color: #2563eb; color: #2563eb; }
        .checkbox-icon { width: 20px; height: 20px; border: 2px solid #cbd5e1; border-radius: 4px; display: flex; align-items: center; justify-content: center; transition: all 0.3s; }
        .equipment-item input[type="checkbox"]:checked + .equipment-label .checkbox-icon { background: #2563eb; border-color: #2563eb; }
        .checkbox-icon::after { content: '✓'; color: white; font-size: 12px; font-weight: bold; opacity: 0; transition: opacity 0.3s; }
        .equipment-item input[type="checkbox"]:checked + .equipment-label .checkbox-icon::after { opacity: 1; }
        
        /* Sidebar */
        .sidebar { position: sticky; top: 32px; }
        .info-card { background: white; border-radius: 16px; padding: 28px; box-shadow: 0 4px 16px rgba(0,0,0,0.06); border: 1px solid #e7e9ec; margin-bottom: 20px; }
        .info-card h3 { font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
        .info-card ul { list-style: none; }
        .info-card li { padding: 10px 0; border-bottom: 1px solid #f1f5f9; color: #64748b; font-size: 14px; line-height: 1.6; display: flex; align-items: flex-start; gap: 8px; }
        .info-card li:last-child { border-bottom: none; }
        .info-card li::before { content: '✓'; color: #10b981; font-weight: bold; flex-shrink: 0; margin-top: 2px; }
        
        .alert { padding: 16px 20px; border-radius: 12px; margin-bottom: 24px; display: none; font-size: 14px; font-weight: 500; }
        .alert.success { background: #d1fae5; border: 2px solid #6ee7b7; color: #065f46; display: block; }
        .alert.error { background: #fee2e2; border: 2px solid #fca5a5; color: #991b1b; display: block; }
        
        .submit-section { margin-top: 32px; padding-top: 32px; border-top: 2px solid #f1f5f9; }
        .submit-btn { width: 100%; padding: 18px; background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 6px 20px rgba(37,99,235,0.3); }
        .submit-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 28px rgba(37,99,235,0.4); }
        .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        .loading { display: none; text-align: center; padding: 20px; }
        .loading.active { display: block; }
        .spinner { border: 3px solid #e2e8f0; border-top: 3px solid #2563eb; border-radius: 50%; width: 40px; height: 40px; animation: spin 0.8s linear infinite; margin: 0 auto 12px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        @media (max-width: 968px) {
            .form-wrapper { grid-template-columns: 1fr; }
            .sidebar { position: static; }
            .form-row { grid-template-columns: 1fr; }
            .page-hero h1 { font-size: 32px; }
            .progress-steps { flex-wrap: wrap; }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="top-bar-content">
            <div class="logo">
                <div class="logo-icon"></div>
                SmartBook
            </div>
            <a href="index.html" class="back-link">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0L0 8l8 8V0z"/></svg>
                Back to Home
            </a>
        </div>
    </div>

    <div class="main-container">
        <div class="page-hero">
            <h1>Book a Conference Room</h1>
            <p>Complete the form below to request your meeting space</p>
        </div>

        <div class="progress-steps">
            <div class="step active">
                
                <span>Your Details</span>
            </div>
            
        </div>

        <div class="form-wrapper">
            <div class="form-card">
                <div id="alertBox" class="alert"></div>

                <form id="bookingForm">
                    <div class="section-header">
                        <div class="section-icon">
                            <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                        </div>
                        <h2>Personal Information</h2>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="requesterName">Full Name <span class="required">*</span></label>
                            <input type="text" id="requesterName" required placeholder="John Smith">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="requesterEmail">Email Address <span class="required">*</span></label>
                                <input type="email" id="requesterEmail" required placeholder="john.smith@company.com">
                            </div>
                            <div class="form-group">
                                <label for="requesterPhone">Contact Phone <span class="required">*</span></label>
                                <input type="tel" id="requesterPhone" required placeholder="+353 1 234 5678">
                            </div>
                        </div>
                    </div>

                    <div class="section-header" style="margin-top: 40px;">
                        <div class="section-icon">
                            <svg viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10z"/></svg>
                        </div>
                        <h2>Booking Details</h2>
                    </div>

                    <div class="form-grid">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bookingDate">Date <span class="required">*</span></label>
                                <input type="date" id="bookingDate" required>
                            </div>
                            <div class="form-group">
                                <label for="roomName">Room <span class="required">*</span></label>
                                <select id="roomName" required>
                                    <option value="">Select a room</option>
                                    <option value="Conference Room A">Conference Room A (20 people)</option>
                                    <option value="Conference Room B">Conference Room B (15 people)</option>
                                    <option value="Meeting Room 1">Meeting Room 1 (8 people)</option>
                                    <option value="Meeting Room 2">Meeting Room 2 (8 people)</option>
                                    <option value="Board Room">Board Room (12 people)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="startTime">Start Time <span class="required">*</span></label>
                                <input type="time" id="startTime" required>
                            </div>
                            <div class="form-group">
                                <label for="endTime">End Time <span class="required">*</span></label>
                                <input type="time" id="endTime" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="attendees">Number of Attendees <span class="required">*</span></label>
                            <input type="number" id="attendees" min="1" max="50" required placeholder="8">
                        </div>

                        <div class="form-group">
                            <label>Required Equipment</label>
                            <div class="equipment-grid">
                                <div class="equipment-item">
                                    <input type="checkbox" id="projector" value="Projector">
                                    <label for="projector" class="equipment-label">
                                        <span class="checkbox-icon"></span>
                                        Projector
                                    </label>
                                </div>
                                <div class="equipment-item">
                                    <input type="checkbox" id="whiteboard" value="Whiteboard">
                                    <label for="whiteboard" class="equipment-label">
                                        <span class="checkbox-icon"></span>
                                        Whiteboard
                                    </label>
                                </div>
                                <div class="equipment-item">
                                    <input type="checkbox" id="videoconf" value="Video Conference">
                                    <label for="videoconf" class="equipment-label">
                                        <span class="checkbox-icon"></span>
                                        Video Conf
                                    </label>
                                </div>
                                <div class="equipment-item">
                                    <input type="checkbox" id="catering" value="Catering">
                                    <label for="catering" class="equipment-label">
                                        <span class="checkbox-icon"></span>
                                        Catering
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="purpose">Meeting Purpose <span class="required">*</span></label>
                            <textarea id="purpose" required placeholder="Brief description of the meeting purpose and agenda..."></textarea>
                        </div>
                    </div>

                    <div class="submit-section">
                        <div class="loading" id="loadingSpinner">
                            <div class="spinner"></div>
                            <p style="color: #64748b;">Submitting your request...</p>
                        </div>
                        <button type="submit" class="submit-btn" id="submitBtn">Submit Booking Request</button>
                    </div>
                </form>
            </div>

            <div class="sidebar">
                <div class="info-card">
                    <h3>What happens next?</h3>
                    <ul>
                        <li>Your request will be reviewed within 30 minutes during business hours</li>
                        <li>You'll receive an email confirmation once processed</li>
                        <li>Check your email for booking details and calendar invite</li>
                        <li>Contact support if you need to modify your booking</li>
                    </ul>
                </div>

                <div class="info-card">
                    <h3>Need help?</h3>
                    <ul>
                        <li>All fields marked with * are required</li>
                        <li>Select equipment based on your meeting needs</li>
                        <li>Booking confirmation sent to your email</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        const firebaseConfig = {
            apiKey: "AIzaSyBpgkK3a800X4zeKGZEdlbEf6G8nzemUJ8",
            authDomain: "smartbook-booking-system.firebaseapp.com",
            projectId: "smartbook-booking-system",
            storageBucket: "smartbook-booking-system.firebasestorage.app",
            messagingSenderId: "476695047912",
            appId: "1:476695047912:web:a0973769c568547610a35d"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const form = document.getElementById('bookingForm');
        const alertBox = document.getElementById('alertBox');
        const submitBtn = document.getElementById('submitBtn');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('bookingDate').setAttribute('min', today);
        function showAlert(message, type) {
            alertBox.textContent = message;
            alertBox.className = `alert ${type}`;
            alertBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            if (type === 'success') setTimeout(() => alertBox.style.display = 'none', 5000);
        }
        function validateForm(data) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(data.requesterEmail)) { showAlert('Please enter a valid email address.', 'error'); return false; }
            const phoneRegex = /^[\d\s\+\-\(\)]+$/;
            if (!phoneRegex.test(data.requesterPhone) || data.requesterPhone.replace(/\D/g, '').length < 10) { showAlert('Please enter a valid phone number (minimum 10 digits).', 'error'); return false; }
            const selectedDate = new Date(data.bookingDate);
            const todayDate = new Date();
            todayDate.setHours(0, 0, 0, 0);
            if (selectedDate < todayDate) { showAlert('Booking date cannot be in the past.', 'error'); return false; }
            const start = data.startTime.split(':');
            const end = data.endTime.split(':');
            const startMinutes = parseInt(start[0]) * 60 + parseInt(start[1]);
            const endMinutes = parseInt(end[0]) * 60 + parseInt(end[1]);
            if (endMinutes <= startMinutes) { showAlert('End time must be after start time.', 'error'); return false; }
            if (selectedDate.toDateString() === todayDate.toDateString()) {
                const now = new Date();
                const currentMinutes = now.getHours() * 60 + now.getMinutes();
                if (startMinutes <= currentMinutes) { showAlert('Start time must be in the future for today\'s bookings.', 'error'); return false; }
            }
            if (data.attendees < 1 || data.attendees > 50) { showAlert('Number of attendees must be between 1 and 50.', 'error'); return false; }
            return true;
        }
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = {
                requesterName: document.getElementById('requesterName').value.trim(),
                requesterEmail: document.getElementById('requesterEmail').value.trim(),
                requesterPhone: document.getElementById('requesterPhone').value.trim(),
                bookingDate: document.getElementById('bookingDate').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                roomName: document.getElementById('roomName').value,
                purpose: document.getElementById('purpose').value.trim(),
                attendees: parseInt(document.getElementById('attendees').value),
                equipment: Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value),
                status: 'Pending',
                submittedAt: serverTimestamp(),
                lastModified: serverTimestamp(),
                processedBy: null,
                internalNotes: ''
            };
            if (!validateForm(formData)) return;
            submitBtn.disabled = true;
            loadingSpinner.classList.add('active');
            alertBox.style.display = 'none';
            try {
                const docRef = await addDoc(collection(db, 'bookings'), formData);
                showAlert(`Booking request submitted successfully! Reference: ${docRef.id.substring(0, 8).toUpperCase()}. You will receive confirmation via email.`, 'success');
                form.reset();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } catch (error) {
                console.error('Error:', error);
                showAlert(`Error submitting booking: ${error.message}. Please try again or contact support.`, 'error');
            } finally {
                submitBtn.disabled = false;
                loadingSpinner.classList.remove('active');
            }
        });
    </script>
</body>
</html>